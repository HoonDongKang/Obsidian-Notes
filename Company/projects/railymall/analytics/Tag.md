
## Recommendations

생성 리스트는 조회된 태그 데이터들로부터 가져온다.
일자 별 조회는 해당 일자 내에 조회된 데이터를 기준으로 태그 데이터를 가져온다.

-> 일자를 조정할 경우, 해당 리스트에 일자 내에 존재하지 않는 조회 데이터들을 리스트에 등장하지 않는다.

- 등록 수 - 일자 내 등록 수 X 누적 등록 수 O
- 조회 수 - 일자 내 조회 수 O
- 전체 조회 수 - 일자 구분 없이 누적 조회 수 O

#### 추천 태그 생성
`비로그인` 
	 - 상관없이 태그 데이터 생성
`로그인` 
	- 00시 ~ 24시 내에 조회 데이터 재조회 시, 해당 데이터 조회 날짜 수정
    - 그 외 데이터, 조회 데이터 새로 생성


## Products

생성 리스트는 등록된 상품 태그 리스트들로부터 가져온다.
일자 별 조회는 해당 일자 내에 클릭된 데이터를 기준으로 태그 데이터를 가져온다.

-> 즉 일자를 조정할 경우, 조회 값이 없는 상품들도 리스트에 남아있으며, 일자는 조회수에만 영향을 준다.

- 등록 수 - 누적 등록 수
- 클릭 수 - 일자 내 클릭 수
- 전체 클릭 수 - 누적 클릭 수
- 상태 
	- 종료: 등록 수가 없거나 상품이 삭제 또는 숨김 처리 되었을 시
	- 그 외

만약 동일 상품이 두 개의 다른 게시글에서 태깅되어진 환경에서 한 명의 유저가 클릭을 했을 때,
등록 수와 클릭 수는 2가 된다.

#### 상품 태그 생성
1. `showcase`  : 유저가 게시글 쇼케이스 생성 시, `product`를 걸어둔다.
	-  해당 게시글 삭제 시, `showcase`데이터 `isDeleted: true` 처리 후, 데이터 삭제 X
		-  이미지 리소스는 삭제
	-  `_totalProducts` 필드 생성 -> 생성부터 `showcase`에 태깅된 모든 상품 _id
2. `shop-tag-log` : 유저가 태그 클릭 시, 클릭 데이터 생성 
	- ( 태그 이벤트에 해당하는 상품이라면 포인트 적립 추가 )
	- 00시 ~ 24시 내에 조회 데이터 재조회 시, 해당 데이터 조회 날짜 수정
    - 그 외 데이터, 조회 데이터 새로 생성

#### 로직 흐름
1. `Showcase` 에 속한 `_products`는 실 등록 여부, `_totalProducts`는 태깅된 모든 상품 목록(통계 리스트)
2. 유저가 태깅 상품을 클릭 시, `tag-log` 생성 - `_product` 값 저장
3. `_totalProducts` 리스트에 `_id` 와 `tag-log`의 `_product`값으로 클릭 수 저장
	- `tag-log` 의 `creatdAt`으로 일자별 클릭 계산 / 그 외, 총 클릭 수
4. `skip, limit`으로 도출된 값의 `_id`를 통해 `showcase` aggregate 돌려서 해당 `_id`의 `_products` 값의 총 개수 계산 (등록 수)

- 유저가 게시글을 삭제해도 조회 데이터는 삭제 X
- 유저가 태그를 변경해도 기존 태깅 `products`존재
- 현재 태깅된 상품들만 등록 수 카운팅, 조회수는 `totalProducts`에서 카운팅